<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DiffWave GUI</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/meyda@5.4.0/dist/web/meyda.min.js"></script>
    <script src="https://unpkg.com/umap-js@1.4.0/lib/umap-js.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/numjs/0.16.0/numjs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
</head>
<body>
    <div class="main-container">
        <h2>DiffWave GUI</h2>
        <div class="grid-container">

            <div class="grid-item full-width">
                <h3>‚òÅÔ∏è Upload Audio File ‚òÅÔ∏è</h3>
                <div id="dropArea" class="drop-area">
                    <p>Drop a WAV file || Click to select one</p>
                </div>
                <input type="file" id="audioFileInput" accept=".wav" style="display:none;">
                <div id="uploadStatus"></div>
            </div>

            <div class="grid-item">
                <h3>üî¨ Analyse Descriptors üî¨</h3>
                <form id="preprocessForm">
                    <div class="grid-container">

                        <!-- Parameters -->
                        <div class="grid-item full-width">
                            <div class="horizontal-group">

                                <div class="form-group">
                                    <label for="sampleRate">SR</label>
                                    <select id="sampleRate" name="sampleRate">
                                        <option value="22050" selected="selected">22.05 kHz</option>
                                        <option value="44100">44.1 kHz</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="nFft">FFT</label>
                                    <select id="nFft" name="nFft">
                                        <option value="256">256</option>
                                        <option value="512">512</option>
                                        <option value="1024" selected="selected">1024</option>
                                        <option value="2048">2048</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="hopLength">Hop</label>
                                    <select id="hopLength" name="hopLength">
                                        <option value="16" selected="selected">16</option>
                                        <option value="32">32</option>
                                        <option value="64">64</option>
                                        <option value="128">128</option>
                                        <option value="256">256</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="winLength">Win</label>
                                    <select id="winLength" name="winLength">
                                        <option value="256">256</option>
                                        <option value="512">512</option>
                                        <option value="1024" selected="selected">1024</option>
                                        <option value="2048">2048</option>
                                    </select>
                                </div>

                            </div>
                        </div>

                        <!-- Descriptors -->
                        <div class="grid-item full-width">
                            <div class="form-group descriptors">
                                <label><input type="checkbox" id="loudness" name="options" value="loudness" checked>Loudness</label>
                                <label><input type="checkbox" id="pitch" name="options" value="pitch" checked>Pitch</label>
                                <label><input type="checkbox" id="mfcc" name="options" value="mfcc" checked>MFCC</label>
                                <label><input type="checkbox" id="chroma" name="options" value="chroma" checked>Chroma</label>
                                <label><input type="checkbox" id="centroid" name="options" value="centroid" checked>Centroid</label>
                                <label><input type="checkbox" id="contrast" name="options" value="contrast" checked>Contrast</label>
                                <label><input type="checkbox" id="bandwidth" name="options" value="bandwidth" checked>Bandwidth</label>
                                <label><input type="checkbox" id="rolloff" name="options" value="rolloff" checked>Rolloff</label>
                                <label><input type="checkbox" id="flatness" name="options" value="flatness" checked>Flatness</label>
                            </div>
                        </div>

                        <!-- UMAP -->
                        <div class="grid-item full-width" style="margin-bottom: 15px;">
                            <div class="form-group centered">
                                <label><input type="checkbox" id="umap" name="umap" value="UMAP" checked>UMAP</label>
                                <input type="number" id="umapDims" name="umap" value="5" min="1" max="20" style="width: 60px;">
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="totalDims">Number of Dimensions:</label>
                        <input type="text" id="totalDims" name="totalDims" readonly>
                    </div>

                    <!-- Buttons -->
                    <div class="form-group" style="margin-top: 10px;">
                        <button type="button" onclick="preprocess()">Analyse</button>
                        <button type="button" onclick="downloadDataset()">Download Dataset</button>
                    </div>
                    <div id="analysisResults"></div>
                </form>
            </div>

            <div class="grid-item">
                <h3>üñ•Ô∏è Train Model üñ•Ô∏è</h3>
                <form id="connectForm">
                    <div class="form-group" style="margin-bottom: 15px;">
                        <!-- OS Selection -->
                        <select id="osSelect" name="osSelect" onchange="updateTrain()">
                            <option value="Windows" selected="selected">Windows</option>
                            <option value="MacOS/Linux">MacOS/Linux</option>
                        </select>
                    </div>

                    <!-- Commands -->
                    <div class="grid-container">
                        <div class="grid-item">
                            <label for="trainOutput_01">01 - SCP</label>
                            <textarea id="trainOutput_01"></textarea>
                            <button type="button" class="copy-button" onclick="copyCommand('trainOutput_01')">Copy</button>
                        </div>
                        <div class="grid-item">
                            <label for="trainOutput_02">02 - SSH</label>
                            <textarea id="trainOutput_02"></textarea>
                            <button type="button" class="copy-button" onclick="copyCommand('trainOutput_02')">Copy</button>
                        </div>
                        <div class="grid-item">
                            <label for="trainOutput_03">03a - Train (Blocking)</label>
                            <textarea id="trainOutput_03"></textarea>
                            <button type="button" class="copy-button" onclick="copyCommand('trainOutput_03')">Copy</button>
                        </div>
                        <div class="grid-item">
                            <label for="trainOutput_04">03b - Train (Non Blocking)</label>
                            <textarea id="trainOutput_04"></textarea>
                            <button type="button" class="copy-button" onclick="copyCommand('trainOutput_04')">Copy</button>
                        </div>
                        <div class="grid-item">
                            <label for="model_ssh">04a - SSH</label>
                            <textarea id="model_ssh"></textarea>
                            <button type="button" class="copy-button" onclick="copyCommand('model_ssh')">Copy</button>
                        </div>
                        <div class="grid-item">
                            <label for="model_convert">04b - ONNX</label>
                            <textarea id="model_convert"></textarea>
                            <button type="button" class="copy-button" onclick="copyCommand('model_convert')">Copy</button>
                        </div>
                        <div class="grid-item full-width">
                            <label for="model_get">04c - Get Model (~/Downloads)</label>
                            <textarea id="model_get"></textarea>
                            <button type="button" class="copy-button" onclick="copyCommand('model_get')">Copy</button>
                        </div>
                    </div>

                    <!-- Bash Script -->
                    <div class="form-group" style="margin-top: 10px;">
                        <button type="button" onclick="downloadScripts()">Download Commands</button>
                    </div>
                </form>
            </div>

            <div class="grid-item full-width">
                <h3>üéµ Inference (Ableton Live) üéµ</h3>
                <div class="form-group" style="margin-top: 10px;">
                        <button type="button" onclick="downloadDevice()">Download Max4Live Device</button>
                </div>
            </div>

        </div>
    </div>
    <script src="script.js"></script>
</body>
</html>
